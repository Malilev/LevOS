import { CONTEXTS } from '../constants';

interface TriggerItem {
  key: string;
  title: string;
  desc: string;
  anchor?: string;
  warn?: string;
  next?: string;
  indent?: boolean;
  highlight?: boolean;
  isChoice?: boolean;
  final?: boolean;
}

interface TriggerSection {
  id: string;
  title: string;
  subtitle?: string;
  items: TriggerItem[];
}

export function getTriggers(scenario: string | null, dayOfWeek: number, context: string): TriggerSection[] {
  const contextName = CONTEXTS[context]?.name || '';
  const sections: TriggerSection[] = [];

  // –£–¢–†–û
  const morning: TriggerSection = {
    id: 'morning',
    title: 'üåÖ –£—Ç—Ä–µ–Ω–Ω—è—è —Ä—É—Ç–∏–Ω–∞',
    subtitle: '–ù–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω –¥–æ –∑—É–±–æ–≤',
    items: [
      { key: 'm1', title: '–í—Å—Ç–∞–ª —Å –∫—Ä–æ–≤–∞—Ç–∏', desc: '–¢—É–∞–ª–µ—Ç ‚Üí —Å—Ä–∞–∑—É –≤ –≤–∞–Ω–Ω—É—é', anchor: '–ù–µ –±—Ä–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω!', next: 'm2' },
      { key: 'm2', title: '–ü–æ—á–∏—Å—Ç–∏–ª –∑—É–±—ã', desc: '–í–∏—Ç–∞–º–∏–Ω—ã + —Å—Ç–∞–∫–∞–Ω –≤–æ–¥—ã', anchor: '–í–∏—Ç–∞–º–∏–Ω—ã —É —Ä–∞–∫–æ–≤–∏–Ω—ã', next: 'm3' },
      { key: 'm3', title: '–ü—Ä–∏–Ω—è–ª –≤–∏—Ç–∞–º–∏–Ω—ã', desc: '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–ø–∏—Å–∫—É "—Å–µ–≥–æ–¥–Ω—è —Å–¥–µ–ª–∞—é ___"', anchor: '–ó–∞–ø–∏—Å–∫–∞ –Ω–∞ —Ç—É–º–±–æ—á–∫–µ' },
    ]
  };

  if (scenario === '3' || scenario === '4') {
    morning.items.push({
      key: 'm_big',
      title: '‚≠ê –ë–æ–ª—å—à–æ–µ –æ–∫–Ω–æ –¥–æ–º–∞!',
      desc: `${scenario === '3' ? '2-3 —á–∞—Å–∞' : '3-4 —á–∞—Å–∞'} –≥–ª—É–±–æ–∫–æ–π —Ä–∞–±–æ—Ç—ã. –ß—Ç–æ –≥–ª–∞–≤–Ω–æ–µ —Å–µ–≥–æ–¥–Ω—è?`,
      anchor: `–ö–æ–Ω—Ç–µ–∫—Å—Ç: ${contextName}`,
      highlight: true
    });
  }

  if (scenario === '4') {
    morning.items.push({
      key: 'm_gym',
      title: 'üèãÔ∏è –ú–æ–∂–Ω–æ –≤ –∑–∞–ª!',
      desc: '–û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ 15:00 ‚Äî –µ—Å—Ç—å –≤—Ä–µ–º—è –Ω–∞ —Å–ø–æ—Ä—Ç',
      anchor: '–í—Ö–æ–¥ –¥–æ 17:00',
      highlight: true
    });
  }

  sections.push(morning);

  // –î–û–†–û–ì–ê (–Ω–µ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö)
  if (scenario !== 'w') {
    sections.push({
      id: 'road',
      title: 'üö∂ –î–æ—Ä–æ–≥–∞ –¥–æ —Ü–µ–Ω—Ç—Ä–∞',
      subtitle: '25 –º–∏–Ω—É—Ç ‚Äî –≤—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º',
      items: [
        { key: 'r1', title: '–í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º', desc: '–°–ø—Ä–æ—Å–∏—Ç—å —Å–µ–±—è: –∫–∞–∫–æ–π —è —Å–µ–π—á–∞—Å?', anchor: '–°—Ç–∏–∫–µ—Ä –Ω–∞ –¥–≤–µ—Ä–∏', isChoice: true },
        { key: 'r_rest', title: 'üò¥ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï', desc: '–£—Å—Ç–∞–ª ‚Äî YouTube, –ø–æ–¥–∫–∞—Å—Ç, –º—É–∑—ã–∫–∞. –ù–µ —Ç—Ä–æ–≥–∞—Ç—å —Ç–µ–ª–µ–≥—Ä–∞–º.', indent: true },
        { key: 'r_react', title: 'üì® –†–ï–ê–ö–¢–ò–í', desc: '–ï—Å—Ç—å –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ ‚Äî –æ—Ç–≤–µ—á–∞—é. –¢–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç—ã, –Ω–µ –∏–Ω–∏—Ü–∏–∏—Ä—É—é.', indent: true },
        { key: 'r_attack', title: '‚öîÔ∏è –ê–¢–ê–ö–ê', desc: '–≠–Ω–µ—Ä–≥–∏—è –µ—Å—Ç—å ‚Äî –ø–∏—à—É –ø–µ—Ä–≤—ã–º –≤—Ä–∞—á–∞–º, –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º, –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º.', indent: true },
      ]
    });
  }

  // –û–ü–ï–†–ê–¶–ò–û–ù–ù–ê–Ø (–Ω–µ –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö)
  if (scenario !== 'w') {
    const hospital: TriggerSection = {
      id: 'hospital',
      title: 'üè• –í –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π',
      subtitle: '–û–∫–Ω–∞ –¥–æ –æ–ø–µ—Ä–∞—Ü–∏–∏',
      items: [
        { key: 'h_30', title: '30 –º–∏–Ω –¥–æ –û–ü', desc: '–¢–æ–ª—å–∫–æ —Ä–µ–∞–∫—Ç–∏–≤: —Å—Ä–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–ª–∞–Ω –¥–Ω—è', warn: '–ù–µ –Ω–∞—á–∏–Ω–∞—Ç—å –≥–ª—É–±–æ–∫–æ–µ!' },
        { key: 'h_60', title: '60 –º–∏–Ω –¥–æ –û–ü', desc: '+2-3 –∞—Ç–∞–∫–∏, –∫–æ—Ä–æ—Ç–∫–∏–π –∑–≤–æ–Ω–æ–∫, –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç—å—é', warn: '–ë–µ–∑ –±–æ–ª—å—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤' },
        { key: 'h_120', title: '120+ –º–∏–Ω –¥–æ –û–ü', desc: '–ì–ª—É–±–æ–∫–∞—è —Ä–∞–±–æ—Ç–∞: —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, —á–µ—Ä–Ω–æ–≤–∏–∫, 5-10 –∞—Ç–∞–∫', warn: '–°–æ–∑–≤–æ–Ω—ã <30 –º–∏–Ω' },
        { key: 'h_end', title: '–í—ã—à–µ–ª –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –û–ü', desc: '–ù–∞–ø–∏—Å–∞—Ç—å –î–∏–∞–Ω–µ "–µ–¥—É"', anchor: '–î–∏–∞–Ω–∞ –∂–¥—ë—Ç', next: 'family' },
      ]
    };

    if (scenario === '3' || scenario === '4') {
      hospital.items.push({
        key: 'h_sport',
        title: '–û–ü –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –¥–æ 15:00?',
        desc: '–û–∫–Ω–æ –¥–ª—è —Å–ø–æ—Ä—Ç–∞! –í—Ö–æ–¥ –≤ –∑–∞–ª –¥–æ 17:00',
        highlight: true
      });
    }

    if (dayOfWeek === 2 || dayOfWeek === 4) {
      hospital.items.push({
        key: 'h_office',
        title: 'üè¢ –ü–æ—Å–ª–µ –û–ü ‚Üí –æ—Ñ–∏—Å',
        desc: dayOfWeek === 2 ? '–í—Ç–æ—Ä–Ω–∏–∫: –ü–æ–ª–µ—á–∞—Ç + –≤—Å—Ç—Ä–µ—á–∏' : '–ß–µ—Ç–≤–µ—Ä–≥: –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∏–ª–∏ –ü–æ–ª–µ—á–∞—Ç',
        highlight: true,
        anchor: '–õ—é–¥–∏ –≤ –æ—Ñ–∏—Å–µ –∂–¥—É—Ç'
      });
    }

    sections.push(hospital);
  }

  // –°–ï–ú–¨–Ø
  sections.push({
    id: 'family',
    title: 'üë®‚Äçüë©‚Äçüëß –°–µ–º—å—è',
    subtitle: scenario === 'w' ? '–í—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å' : '–í–µ—á–µ—Ä –¥–æ–º–∞',
    items: scenario === 'w' ? [
      { key: 'f_morning', title: '–£—Ç—Ä–æ —Å —Å–µ–º—å—ë–π', desc: '–ó–∞–≤—Ç—Ä–∞–∫, –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–µ', anchor: '–î–∏–∞–Ω–∞, –ú–∞–π' },
      { key: 'f_walk', title: '~14:00 –ü—Ä–æ–≥—É–ª–∫–∞ —Å –ú–∞–π', desc: '1-2 —á–∞—Å–∞ –Ω–∞ —É–ª–∏—Ü–µ', anchor: '–î–∏–∞–Ω–∞ –∂–¥—ë—Ç –ø–µ—Ä–µ–¥—ã—à–∫—É' },
      { key: 'f_sport', title: '–°–≤–æ–±–æ–¥–Ω–æ–µ –æ–∫–Ω–æ', desc: '–°–ø–æ—Ä—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏', highlight: true },
    ] : [
      { key: 'f_mai', title: '50 –º–∏–Ω—É—Ç —Å –ú–∞–π', desc: '–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–∏—Ö–æ–¥–∞ –¥–æ–º–æ–π ‚Äî –¥–æ—á—å', anchor: '–î–∏–∞–Ω–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç', next: 'evening' },
      { key: 'f_20', title: '20:00 ‚Äî –±—ã—Ç—å –¥–æ–º–∞', desc: '–ï—Å–ª–∏ –µ—â—ë —Ä–∞–±–æ—Ç–∞—é ‚Äî –∑–∞–∫–æ–Ω—á–∏—Ç—å', warn: '–î–µ–¥–ª–∞–π–Ω!' },
    ]
  });

  // –í–ï–ß–ï–† (—Ä–∞–±–æ—á–∏–µ –¥–Ω–∏)
  if (scenario !== 'w') {
    const evening: TriggerSection = {
      id: 'evening',
      title: 'üåô –û–∫–Ω–æ —Å–æ–≤—ã',
      subtitle: `–ö–æ–Ω—Ç–µ–∫—Å—Ç: ${contextName}`,
      items: [
        { key: 'e_start', title: '50 –º–∏–Ω —Å –ú–∞–π –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å', desc: `–û—Ç–∫—Ä—ã—Ç—å –∑–∞–ø–∏—Å–∫—É, –∑–∞–¥–∞—á–∞ –ø–æ ${contextName}`, next: 'e_work' },
        { key: 'e_yt', title: '–•–æ—á–µ—Ç—Å—è YouTube?', desc: '–°–Ω–∞—á–∞–ª–∞ –û–î–ù–û –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ –∑–∞–¥–∞—á–µ, –ø–æ—Ç–æ–º YouTube', warn: '–ù–µ –Ω–∞–æ–±–æ—Ä–æ—Ç!' },
        { key: 'e_hyper', title: 'üî• –ù–∞–∫—Ä—ã–ª –≥–∏–ø–µ—Ä—Ñ–æ–∫—É—Å', desc: '–ù–µ –º–µ—à–∞—Ç—å —Å–µ–±–µ, –µ—Ö–∞—Ç—å –¥–æ –∫–æ–Ω—Ü–∞. 3-6 —á–∞—Å–æ–≤.', highlight: true },
        { key: 'e_fly', title: '–ü—Ä–∏–ª–µ—Ç–µ–ª–∞ –∑–∞–¥–∞—á–∞', desc: '–ó–∞–ø–∏—Å–∞—Ç—å –≤ "–ø—Ä–∏–ª–µ—Ç–µ–ª–æ", –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–æ–º—É —á—Ç–æ –¥–µ–ª–∞–ª', anchor: 'Brain dump' },
      ]
    };

    if (dayOfWeek === 0) {
      evening.items.push({
        key: 'e_report',
        title: 'üìä 21:00 ‚Äî –û—Ç—á—ë—Ç –∏–Ω–≤–µ—Å—Ç–æ—Ä—É',
        desc: '5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –¥–∞–∂–µ –µ—Å–ª–∏ —Å—Ç—ã–¥–Ω–æ!',
        highlight: true,
        anchor: '–ë—É–¥–∏–ª—å–Ω–∏–∫'
      });
      evening.items.push({
        key: 'e_review',
        title: '–ü–æ—Å–ª–µ –æ—Ç—á—ë—Ç–∞',
        desc: '–û–±–∑–æ—Ä —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤: –∫–∞–∫–∏–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏? + —Ñ–æ–∫—É—Å –Ω–µ–¥–µ–ª–∏'
      });
    }

    sections.push(evening);
  }

  // –°–û–ù
  sections.push({
    id: 'sleep',
    title: 'üò¥ –ü–µ—Ä–µ–¥ —Å–Ω–æ–º',
    subtitle: '–ü–æ—Ä—è–¥–æ–∫: –∑–∞–ø–∏—Å–∫–∞ ‚Üí –∑—É–±—ã ‚Üí –∫—Ä–æ–≤–∞—Ç—å',
    items: [
      { key: 's1', title: '–†–µ—à–∏–ª –ª–æ–∂–∏—Ç—å—Å—è', desc: `–ó–∞–ø–∏—Å–∞—Ç—å: "–∑–∞–≤—Ç—Ä–∞ –ø–æ ${contextName} —Å–¥–µ–ª–∞—é: ___"`, anchor: '–ë–ª–æ–∫–Ω–æ—Ç –Ω–∞ —Ç—É–º–±–æ—á–∫–µ', next: 's2' },
      { key: 's2', title: '–ó–∞–ø–∏—Å–∞–ª', desc: '–¢—É–∞–ª–µ—Ç ‚Üí –∑—É–±—ã', next: 's3' },
      { key: 's3', title: '–ü–æ—á–∏—Å—Ç–∏–ª –∑—É–±—ã', desc: '–õ—ë–≥. –î–µ–Ω—å –∑–∞–∫—Ä—ã—Ç.', final: true },
    ]
  });

  return sections;
}
